{"version":3,"file":"commonHelpers.js","sources":["../src/pixaby_api.js","../src/main.js"],"sourcesContent":["import axios from 'axios';\n\nconst BASE_URL = 'https://pixabay.com/api/';\nconst API_KEY = '40888017-179b7a421750c84ea86ef3d3f';\n\naxios.defaults.baseURL = BASE_URL;\naxios.defaults.params = {\n  key: API_KEY,\n  image_type: 'photo',\n  orientation: 'horizontal',\n  safesearch: 'true',\n  per_page: 40,\n};\n\nasync function serviceGetImages(searchQuery, page) {\n  const instance = axios.create({\n    params: {\n      q: searchQuery,\n      page,\n    },\n  });\n\n  const response = await instance.get();\n\n  if (!response.data.totalHits) {\n    throw new Error(\n      'Sorry, there are no images matching your search query. Please try again.'\n    );\n  }\n\n  page += 1;\n\n  return response.data;\n}\n\nexport { serviceGetImages };\n","import { serviceGetImages } from './pixaby_api';\n\nimport iziToast from 'izitoast';\nimport SimpleLightbox from 'simplelightbox';\n\nimport 'izitoast/dist/css/iziToast.min.css';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\n\nconst elements = {\n  searchForm: document.querySelector('.search-form'),\n  gallery: document.querySelector('.gallery'),\n  guard: document.querySelector('.js-guard'),\n};\n\nelements.searchForm.addEventListener('submit', handlerSearch);\n\nconst options = {\n  root: null,\n  rootMargin: '300px',\n  threshold: 1.0,\n};\n\nconst observer = new IntersectionObserver(handlerLoadMore, options);\n\nlet page;\nlet searchQuery;\nlet shownItemCounter = 0;\n\nasync function handlerSearch(event) {\n  event.preventDefault();\n\n  try {\n    searchQuery = elements.searchForm.searchQuery.value;\n\n    page = 1;\n\n    const totalHits = await serviceImages();\n\n    showSuccessMessage(totalHits);\n    observer.observe(elements.guard);\n  } catch (err) {\n    showErrorMessage(err.message);\n  } finally {\n    elements.searchForm.reset();\n  }\n}\n\nasync function serviceImages() {\n  const { hits, totalHits } = await serviceGetImages(searchQuery, page);\n\n  elements.gallery.insertAdjacentHTML('beforeend', createMarkup(hits));\n  shownItemCounter += 40;\n\n  if (shownItemCounter >= totalHits) {\n    observer.disconnect();\n  }\n\n  initializeLightbox();\n  return totalHits;\n}\n\nfunction createMarkup(array) {\n  return array\n    .map(item => {\n      const {\n        webformatURL,\n        largeImageURL,\n        tags,\n        likes,\n        views,\n        comments,\n        downloads,\n      } = item;\n\n      return `\n      <a href=\"${largeImageURL}\" class=\"photo-card\" data-lightbox=\"gallery\">\n        <img src=\"${webformatURL}\" alt=\"${tags}\" loading=\"lazy\" />\n        <div class=\"info\">\n          <p class=\"info-item\">\n            <b>Likes</b> ${likes}\n          </p>\n          <p class=\"info-item\">\n            <b>Views</b> ${views}\n          </p>\n          <p class=\"info-item\">\n            <b>Comments</b> ${comments}\n          </p>\n          <p class=\"info-item\">\n            <b>Downloads</b> ${downloads}\n          </p>\n        </div>\n      </a>`;\n    })\n    .join('');\n}\n\nfunction handlerLoadMore(entries) {\n  entries.forEach(async entry => {\n    if (entry.isIntersecting) {\n      page += 1;\n\n      enableSmoothScroll();\n      serviceImages();\n    }\n  });\n}\n\nfunction initializeLightbox() {\n  const lightbox = new SimpleLightbox('.gallery a');\n  lightbox.refresh();\n}\n\nfunction showSuccessMessage(totalHits) {\n  iziToast.success({\n    message: `Hooray! We found ${totalHits} images.`,\n    position: 'topRight',\n  });\n}\n\nfunction showErrorMessage(message) {\n  iziToast.error({\n    message,\n    position: 'topRight',\n  });\n}\n\nfunction enableSmoothScroll() {\n  const { height: cardHeight } =\n    elements.gallery.firstElementChild.getBoundingClientRect();\n\n  window.scrollBy({\n    top: cardHeight * 2,\n    behavior: 'smooth',\n  });\n}\n"],"names":["BASE_URL","API_KEY","axios","serviceGetImages","searchQuery","page","response","elements","handlerSearch","options","observer","handlerLoadMore","shownItemCounter","event","totalHits","serviceImages","showSuccessMessage","err","showErrorMessage","hits","createMarkup","initializeLightbox","array","item","webformatURL","largeImageURL","tags","likes","views","comments","downloads","entries","entry","enableSmoothScroll","SimpleLightbox","iziToast","message","cardHeight"],"mappings":"owBAEA,MAAMA,EAAW,2BACXC,EAAU,qCAEhBC,EAAM,SAAS,QAAUF,EACzBE,EAAM,SAAS,OAAS,CACtB,IAAKD,EACL,WAAY,QACZ,YAAa,aACb,WAAY,OACZ,SAAU,EACZ,EAEA,eAAeE,EAAiBC,EAAaC,EAAM,CAQjD,MAAMC,EAAW,MAPAJ,EAAM,OAAO,CAC5B,OAAQ,CACN,EAAGE,EACH,KAAAC,CACD,CACL,CAAG,EAE+B,MAEhC,GAAI,CAACC,EAAS,KAAK,UACjB,MAAM,IAAI,MACR,0EACN,EAGE,OAAAD,GAAQ,EAEDC,EAAS,IAClB,CCzBA,MAAMC,EAAW,CACf,WAAY,SAAS,cAAc,cAAc,EACjD,QAAS,SAAS,cAAc,UAAU,EAC1C,MAAO,SAAS,cAAc,WAAW,CAC3C,EAEAA,EAAS,WAAW,iBAAiB,SAAUC,CAAa,EAE5D,MAAMC,EAAU,CACd,KAAM,KACN,WAAY,QACZ,UAAW,CACb,EAEMC,EAAW,IAAI,qBAAqBC,EAAiBF,CAAO,EAElE,IAAIJ,EACAD,EACAQ,EAAmB,EAEvB,eAAeJ,EAAcK,EAAO,CAClCA,EAAM,eAAc,EAEpB,GAAI,CACFT,EAAcG,EAAS,WAAW,YAAY,MAE9CF,EAAO,EAEP,MAAMS,EAAY,MAAMC,IAExBC,EAAmBF,CAAS,EAC5BJ,EAAS,QAAQH,EAAS,KAAK,CAChC,OAAQU,EAAP,CACAC,EAAiBD,EAAI,OAAO,CAChC,QAAY,CACRV,EAAS,WAAW,OACrB,CACH,CAEA,eAAeQ,GAAgB,CAC7B,KAAM,CAAE,KAAAI,EAAM,UAAAL,CAAW,EAAG,MAAMX,EAAiBC,EAAaC,CAAI,EAEpE,OAAAE,EAAS,QAAQ,mBAAmB,YAAaa,EAAaD,CAAI,CAAC,EACnEP,GAAoB,GAEhBA,GAAoBE,GACtBJ,EAAS,WAAU,EAGrBW,IACOP,CACT,CAEA,SAASM,EAAaE,EAAO,CAC3B,OAAOA,EACJ,IAAIC,GAAQ,CACX,KAAM,CACJ,aAAAC,EACA,cAAAC,EACA,KAAAC,EACA,MAAAC,EACA,MAAAC,EACA,SAAAC,EACA,UAAAC,CACD,EAAGP,EAEJ,MAAO;AAAA,iBACIE;AAAA,oBACGD,WAAsBE;AAAA;AAAA;AAAA,2BAGfC;AAAA;AAAA;AAAA,2BAGAC;AAAA;AAAA;AAAA,8BAGGC;AAAA;AAAA;AAAA,+BAGCC;AAAA;AAAA;AAAA,WAI/B,CAAK,EACA,KAAK,EAAE,CACZ,CAEA,SAASnB,EAAgBoB,EAAS,CAChCA,EAAQ,QAAQ,MAAMC,GAAS,CACzBA,EAAM,iBACR3B,GAAQ,EAER4B,IACAlB,IAEN,CAAG,CACH,CAEA,SAASM,GAAqB,CACX,IAAIa,EAAe,YAAY,EACvC,QAAO,CAClB,CAEA,SAASlB,EAAmBF,EAAW,CACrCqB,EAAS,QAAQ,CACf,QAAS,oBAAoBrB,YAC7B,SAAU,UACd,CAAG,CACH,CAEA,SAASI,EAAiBkB,EAAS,CACjCD,EAAS,MAAM,CACb,QAAAC,EACA,SAAU,UACd,CAAG,CACH,CAEA,SAASH,GAAqB,CAC5B,KAAM,CAAE,OAAQI,CAAY,EAC1B9B,EAAS,QAAQ,kBAAkB,wBAErC,OAAO,SAAS,CACd,IAAK8B,EAAa,EAClB,SAAU,QACd,CAAG,CACH"}